<!doctype html>
<html lang="en" class="h-full antialiased">
  <head>
    <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Setting Up a Local AI-Powered Ruby on Rails Environment · AI on Rails</title>
<meta name="title" content="Setting Up a Local AI-Powered Ruby on Rails Environment · AI on Rails" />
<meta name="description" content="Discover how to integrate AI into your Ruby on Rails application without the need for expensive API calls." />
<link href="/images/favicon.ico" rel="icon" type="image/ico" />

    <link href="/stylesheets/tailwind.css" rel="stylesheet" />
    <link href="/stylesheets/code_highlighting.css" rel="stylesheet" />
    <script src="/javascripts/site.js"></script>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="5dde56bc-9822-4d4c-a606-0bd521350c76"></script>
  </head>
  <body class="flex h-full bg-zinc-50">
    <div class="flex w-full">
      <div class="fixed inset-0 flex justify-center sm:px-8">
        <div class="flex w-full max-w-7xl lg:px-8">
          <div class="w-full bg-white ring-1 ring-zinc-100"></div>
        </div>
      </div>
      <div class="relative flex w-full flex-col">
        
<header class="pointer-events-none relative z-50 flex flex-none flex-col">
  <div class="top-0 z-10 h-16 pt-6">
    <div class="sm:px-8 top-6 w-full">
      <div class="mx-auto w-full max-w-7xl lg:px-8">
        <div class="relative px-4 sm:px-8 lg:px-12">
          <div class="mx-auto max-w-2xl lg:max-w-5xl">
            <div class="relative flex gap-4">
              <div class="flex flex-1">
                <div class="h-10 w-10 p-0.5"><a aria-label="Home" class="pointer-events-auto" href="/"><img alt="ai-on-rails.com" fetchpriority="high" width="512" height="512" decoding="async" data-nimg="1" class="h-9 w-9" sizes="2.25rem" src="/images/ai-on-rails.png" style="color: transparent;"></a></div>

              </div>
              <div class="flex flex-1 justify-end md:justify-center">
                <nav class="pointer-events-auto hidden md:block">
                  <ul class="flex rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur">
                    <li>
                      <a class="relative block px-3 py-2 transition hover:text-teal-500" href="//">Home</a>
                    </li>
                    <li>
                      <a class="relative block px-3 py-2 transition hover:text-teal-500" href="/articles/">Articles</a>
                    </li>
                    <li>
                      <a class="relative block px-3 py-2 transition hover:text-teal-500" href="/author/">Author</a>
                    </li>
                  </ul>
                </nav>
              </div>
              <div class="flex justify-end md:flex-1"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

        <main clas="flex-auto">
          <div class="sm:px-8 mt-12 lg:mt-16">
            <div class="relative px-4 sm:px-8 lg:px-12">
              <div class="mx-auto w-full max-w-7xl lg:px-8">
                <div class="relative px-4 sm:px-8 lg:px-12">
                  <div class="mx-auto max-w-2xl lg:max-w-5xl">
                      <div class="mx-auto max-w-2xl lg:max-w-5xl">
    <div class="xl:relative">
      <div class="mx-auto max-w-2xl">
        <div id="prose-content" class="prose">
          <h1 id="setting-up-a-local-ai-powered-ruby-on-rails-environment">Setting Up a Local AI-Powered Ruby on Rails Environment</h1>

<details class="italic"><summary>Table of Contents</summary><aside>
<ul id="markdown-toc">
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#step-1-download-llamafile" id="markdown-toc-step-1-download-llamafile">Step 1. Download llamafile</a></li>
  <li><a href="#step-2-set-up-foreman" id="markdown-toc-step-2-set-up-foreman">Step 2. Set Up Foreman</a></li>
  <li><a href="#step-3-start-your-rails-application" id="markdown-toc-step-3-start-your-rails-application">Step 3. Start Your Rails Application</a></li>
  <li><a href="#step-4-happy-coding-and-ai-integrating" id="markdown-toc-step-4-happy-coding-and-ai-integrating">Step 4. Happy Coding and AI Integrating!</a></li>
</ul>

  </aside></details>

<h2 id="overview">Overview</h2>

<p>Integrating AI into your Ruby on Rails application can enhance its capabilities, but relying on external APIs can be costly. This guide will show you how to set up a local AI environment using <a href="https://llamafile.ai/" target="_blank">llamafile</a> and Foreman to run your AI models alongside your Rails application.</p>

<h2 id="step-1-download-llamafile">Step 1. Download llamafile</h2>

<p>First, download the <code>Meta-Llama-3-8B-Instruct.Q4_0.llamafile</code> or a model of your choice from <a href="https://huggingface.co/Mozilla/Meta-Llama-3-8B-Instruct-llamafile" target="_blank">huggingface.co</a> and save it in the <code>storage</code> directory within your Rails application.</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nb">cd </span>storage
wget https://huggingface.co/Mozilla/Meta-Llama-3-8B-Instruct-llamafile/resolve/main/Meta-Llama-3-8B-Instruct.Q4_0.llamafile?download<span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<p>Make sure the downloaded llamafile is executable:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="nb">chmod</span> +x storage/Meta-Llama-3-8B-Instruct.Q4_0.llamafile
</code></pre></div>
<h2 id="step-2-set-up-foreman">Step 2. Set Up Foreman</h2>

<p>Install Foreman, a tool to manage multiple processes for your Rails application:</p>

<div class="highlight"><pre class="highlight shell"><code>gem <span class="nb">install </span>foreman
</code></pre></div>
<p>Create or update the <code>Procfile.dev</code> in your Rails application to include the web server and AI model:</p>

<div class="highlight"><pre class="highlight shell"><code><span class="c"># Procfile.dev</span>
web: bin/rails server
ai: storage/Meta-Llama-3-8B-Instruct.Q4_0.llamafile <span class="nt">--nobrowser</span>
</code></pre></div>
<h2 id="step-3-start-your-rails-application">Step 3. Start Your Rails Application</h2>

<p>Run your Rails application along with the AI model using Foreman:</p>

<div class="highlight"><pre class="highlight shell"><code>foreman start <span class="nt">-f</span> Procfile.dev
</code></pre></div>
<p><strong>Note:</strong> The llamafile readme provides addional gotchas and tips for running the server locally.</p>

<h2 id="step-4-happy-coding-and-ai-integrating">Step 4. Happy Coding and AI Integrating!</h2>

<p>Your AI model will be available at <code>http://localhost:8080</code>, providing an API similar to OpenAI’s. You can use the <a href="https://github.com/alexrudall/ruby-openai" target="_blank">OpenAI Gem</a> by configuring it to point to your local llamafile API, or develop your own API client.<br />
For more details on the API endpoints, refer to the <a href="https://github.com/Mozilla-Ocho/llamafile/blob/main/llama.cpp/server/README.md#api-endpoints" target="_blank">llamafile repository</a>.</p>


        </div>
      </div>
    </div>
  </div>

                  </div>
                </div>
              </div>
            </div>
            <div class="mx-auto w-full max-w-7xl lg:px-8"></div>
          </div>
        </main>
        
<footer class="mt-32 flex-none">
  <div class="sm:px-8">
    <div class="mx-auto w-full max-w-7xl lg:px-8">
      <div class="border-t border-zinc-100 pb-16 pt-10">
        <div class="relative px-4 sm:px-8 lg:px-12">
          <div class="mx-auto max-w-2xl lg:max-w-5xl">
            <div class="flex flex-col items-center justify-between gap-6 sm:flex-row">
              <div class="flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800">
                  <a class="hover:text-teal-500" href="/">Home</a>
                  <a class="hover:text-teal-500" href="/articles">Articles</a>
                  <a class="hover:text-teal-500" href="/author">Author</a>
              </div>
              <p class="text-sm text-zinc-400">© <!-- -->2024<!-- --> No rights reserved.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

      </div>
    </div>
  </body>
</html>
